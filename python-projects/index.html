<html>
    <head>
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
        <link href="simple-sidebar.css" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/default.min.css">
        <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script src="https://code.jquery.com/jquery-2.2.4.min.js" type="text/javascript"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
        <link href="reg.css" rel="stylesheet">
            <script type="text/javascript">
      window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
        heap.load("1670837857");
  </script>
    </head>
    <body>

    <div id="wrapper">

        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="sidebar-brand">
                    <a href="#">
                        Practical Python Projects
                    </a>
                </li>
                <li class="active">
                    <a href="#">Introduction</a>
                </li>
                <li>
                    <a href="javascript:void(0)" onclick="scrollto('#project_1')"> 1 - Folder Cleanup</a>
                </li>
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-8">
                            <h1>Practical Python Projects</h1>
                        <br>
                        <br>
                        <p class="lead"> It seems like everyone always tells you that the best way to learn a programming language, is to make stuff. You might of read tons of quora answers, or stack overflow questions telling you the best way to learn langauge X is to undertake some sort of project. But how do you know what to make? We've compiled a list of some practical tools you might want to write for your PC, that will you teach you the basics, as well as much of the standard library of Python. 
                            </p>
                    </div>
                </div>
                <div style="height:25%"></div>
                <div class = "row" id="project_1">
                    <div class="col-lg-8">
                        <h3> Project 1 - Folder Cleanup </h3>
                        <hr>
                        <img src="img/too_many_cooks.jpg"/>
                        <div style="height:5%"></div>
                        <p>It's pretty common to need to periodically clean up folders on your PC, (if you aren't already freakishly organized about these sorts of things, in that case, skip this one)
                        <br>
                        We're going to build a project that allows you to write a configuration file, that you can use to periodically clean up a specific folder on your PC, by deleting and moving files based on how old they are, what type of file they are, and what the file's name is. 
                        </p>
                        <br>
                        <p>
                            We'll have a configuration file that looks something like this:
                        </p>
                        <pre><code class="javascript">
{
    "target_folder": "C:\\Users\\Me\\Documents",
    "actions": [
            {
                "type": "extension",
                "name": [".png", "jpg", ".gif"],
                "task": "move",
                "target": "C:\\Users\\Me\\Images"
            }
    
    ]
}       
                        </code></pre>
                        <p>
                            This is a JSON (Javascript Object Notation) file. It's a pretty easy way to describe sets of related information, and in this case, that's exactly what we'll need  to describe how we want our folder to be cleaned up.
                            in JSON, each key, (the text between the quotes on the left side of the colon) has a corresponding value (the text on the left side of the colon).
                            <br>
                            <br>
                            For example: <br> 
                            <code>{"key": "value"}</code>
                            <br>
                            <br>

                            The braces that you see on the outside, denote that this is one JSON <i>object</i>. Objects can contain either basic values, arrays, or other objects, which recursively can contain the same. This particular JSON object that we have here, describes a rule 
                            for how we want to handle a certain type of files in our folder cleanup.
                            <br>
                            <br>
                            The first key and value set, is the <code>target_folder</code> we'll use this key to determine which folder it is that we're going to be cleaning up. We need to use double slashes here because the backslash normally is for special escape characters in Python, so we need to indicate that we're <i>not</i> doing that.
                            <br>
                            <br>
                            The <code>actions</code> key, will determine all the possible actions we can take when looking at what to do with a particular file. <code>actions</code> is a list containing JSON objects
                            that describe all the possible actions 
                            <br>
                            <br>
                            The actions will be a list of rules, for a set of conditions: If this file ends with .png, move it to the pictures folder, If this file ends with .zip, delete it.
                            <br>
                            <br>
                            The structure that we'll use for the actions contains a <code>type</code> key, that will let you know which way we're going to inspect the file in order to determine if it matches this rule,
                            For instance, in our example above, we're going to look at the file extension to determine if we should apply this action.
                            <br>
                            <br>
                            The <code>name</code> key, will determine what the actual condition is, once we've determined what way we're looking at the file, since we're looking at the extension in or example, we next provide a list of file extensions to match
                            <br>
                            <br>
                            Then we specify a <code>task</code> which describes exactly what we want to do with the files that match the condition. In this case, that's move the file somewhere
                            <br>
                            <br>
                            And then finally in some cases, we might need to specify a target for the task, like <i>where</i> to move the file to, so for that, we use the <code>target</code> key.
                            <br>
                            <br>
                            So in total, our rule above just will move any files with the extensions, .png, .jpg and .gif it finds to the C:\Users\Me\Images folder on your computer.

                            <br>
                            <br>
                            Enough with all that boring description stuff, let's get started!
                            <br>
                            <br>
                            <div class="alert alert-warning" role="alert"> <b>Note:</b> We're going to be using <a href="https://code.visualstudio.com/">Visual Studio Code</a> as our editor, and windows as our platform with the <a href="http://babun.github.io/">babun</a> shell.
                            On OSX or Linux you can use the same instructions, since we're just going to be running python and editing code. 
                            </div>
                            <div class="alert alert-warning" role="alert"> <b>Other Note:</b> We're assuming you have python and your editors set up already. If you don't, start
                            <a href="https://wiki.python.org/moin/BeginnersGuide/Download">HERE</a>
                            </div>
                            <img src="img/cleanup_1.png"/>
                            <br>
                            <br>
                            <p>
                                You can get started, by copying our example config above, into an actual file so we can start with loading it.
                                <br>
                                <br>
                                We can save our file as a .json file, it should look something like this.
                                <img src="img/cleanup_2.png"/>
                                <br>
                                So the first thing you'll need to do in python, is load the .json file that we've just saved.
                            </p>
                            <p>
                                To load a file in python, you can use the built in <code>open()</code> function, and pass it the name of your file.
                                <code>open()</code> requires 2 paramaters, 1 to specify the name of the file, and another for the <i> file mode </i>
                                the mode basically indicates what you're going to do with the file once it's opened. Since we're going to read data from our file, we use the <code>"r"</code> mode.
                        </p>
                        <br>
                        <p>
                            The <code>open()</code> function returns a file object, that you can call the <code>.read()</code> method on, to get the data from, which should in turn, return you a string that you can store in a variable, as you see below.
                        </p>
                        <br>
                        <img src="img/cleanup_3.png" />
                        <br>
                        <p>
                            Since we're not specifying the whole path to the file, in this example we're expecting the .json file to be in the same folder as your python program. To make sure that you've loaded the right file, you can put a <code>print</code> statement (or <code>print()</code> function if you happen to be using python 3) and print out the result of the <code>.read()</code> call.
                        </p>
                        <br>
                        <p>
                            That should look something like this:
                        </p>
                        <img src="img/cleanup_4.png"/>
                        <br>
                        <p>
                            And once you've run the program, you can open a terminal or command prompt and navigate to where you have the program stored and run <code>python folder_cleanup.py</code>
                        </p>
                        <br>
                        <p>You should see something like this:</p>
                        <img src="img/cleanup_5.png"/>
                        <br>

                        <p>
                            This allows us to see the data stored in our file, but it's not actually a python dictionary, just a large string containing a JSON definition. We're going to need to import a module from the python standard library in order to convert our JSON string into a python dictionary we can work with.
                            <br>
                            The Python standard library has a <code>json</code> module that you can import, to load JSON into python dictionaries.
                        </p>

                        <br>
                        <p> All you need to do to convert the string into a dictionary is call the <code>.loads()</code> function from the <code>json</code> module.
                        <pre><code class="python">
import json
json.loads(cleanup_configuration)
</code>
                        </pre>
                        </p>
                        <br>
                        <p>
                            You can call <code>.loads()</code> directly on the result of the <code>.read()</code> method, and get your python dictionary from the file in one line:
                        </p>
                        <br>
                        <img src="img/cleanup_6.png"/>
                        <br>
                        <p>
                            The <code>cleanup_configuration</code> variable, should now have a python dictionary in it you can work with!
                        </p>
                        <br>
                        <p>
                            From here, the rest of the process is simple, you need to run through the files in your target directory, and then run the rules on each file.
                        </p>
                        <br>
                        <p> To get a list of all the file names in a particular folder, you can use a function from another standard library module, <code>os</code>.
                        the operating system module, has a funtion called <code>listdir</code> that you can use to accomplish this.
                        </p>
                        <br>
                        <p>
                            To test it out, we can start by loading the <code>"target_folder"</code> key from our configuration dictionary, and listing all the files in that directory, and then printing out that list. Make sure you replace the <code>"target_folder"</code> key in your JSON file with a path to an actual directory on your PC, or you might get an error.
                        </p>
                        <br>
                        <p>Like this:</p>
                        <img src="img/cleanup_7.png" />
                        <br>
                        <p> After running the python program, you should get the output of a list, with some filenames, that looks something like this, depending on the actual files you have in the directory you chose.
                        </p>
                        <br>
                        <img src="img/cleanup_8.png" />
                        <br>
                        <p>
                            From here, we need to execute the rules against each file name, to see if we need to perform a task on the file.
                        </p>
                        <br>
                        <p> The first type of rule we can handle, is the rules that are concerned with the file's <i>extension</i>. What we'll need to do for this, is get the file's extension from it's name, and check it up against our list of file extensions.
                        <br>
                        Since the file name is a string, we can <code>.split()</code> the string in order to get it's extension
                        </p>
                        <p>
                            for example, to get the extension from a file called <code>image.png</code> you could run code like this:
                        </p>
                        <pre>
                        <code class="python">
file_ext = "image.png".split(".")[-1]
file ext == "png"
                        </code>
                        </pre>
                        <br>
                        <p>
                            How this works is that, <code>.split()</code> splits a string into chunks by a given <i>delimiter</i>. Every time we see the delimiter, we split the string again. In this case, we pass the dot as our string delimiter, and get the last item in the array, which will be whatever characters occured after the dot, and in this case, that's our file extension.
                        </p>
                        <br>
                        <p> You can take a look at this in the <code>python</code> interpreter:
                        </p>
                        <img src="img/cleanup_10.gif">
                        <br>
                        <p>
                            So, in order to tell whether our file has one of the extensions we have a rule for, we can loop through the actions, and look at the actions and what they specify
                        </p>
                        <br>
                        <p> we can start to write a function that will run through our actions and run them if necessary given a particular file name</p>
                        <pre>
                            <code class="python">
def run_actions(file_name, actions):
    for action in actions:
        if action['type'] == "extension" and file_name.split(".")[-1].lower() in action['name']:
            run_task()
                            </code></pre>
                            <br>
                            <p> So this might look a little <i>scary</i> and that's understandable, but all we're doing here, is grabbing the file extension, and checking whether it's <code>in</code> the array of extension names we have specified in our action. We call <code>.lower()</code> on our file extension to convert it to lowercase just in case the file extension is uppercase. So this condition will let us know whether to run the task associated with this particular action or not.</p>
                            <br>
                            <p> We're going to have a set number of tasks, so we can use a dictionary to store the functions that the tasks will run in our program. The first and most basic task we'll be performing is moving files to a <code>target</code> location specified within the action JSON
                            </p>
                            <pre><code class="python">
def move_file(path, target):
    shutil.move(path, target)

tasks = {
    'move': move_file
}
                                </code></pre>
                                <p> We're going to use another module from the standard library <code>shutil</code> to help with the file operations. It has a function built-in (<code>.move()</code>) that allows us to easily move a file from one location to another.
                                </p>
                                <br>
                                <p> The task function can be stored in our dictionary, and then looked up when our file name meets the condition for the action that needs to fire the task. Like this:</p>
                                <br>
                                <pre>
                                    <code class="python">
def run_actions(file_name, actions):

    for action in actions:
        if action['type'] == "extension" and file_name.split(".")[-1].lower() in action['name']:
            tasks[action['task']](target_folder+"/"+file_name, action['target']) 

                                    </code>
                                </pre>
                                <br>
                                <p> Once again, this looks like a lot, so we can step through it. The first few lines are the same as what we had before, our condition to make sure that we're matching based on the file extension. But the next line picks up our task using the <code>tasks</code> dictionary we created in the earlier code sample. Since the tasks dictionary contains a function, we pask the name of the task from our action dictionary to the tasks dictonary ( <code>tasks[action['task']]</code> )  to get back the right function to run, and then we pass in the target folder plus the file name, and an extra slash as a paramater to our task, along with the task's "target" key</p>
                                <br>
                                <p>
                                    The extra slash is to form an appropriate path to our file, the direction of the slashes is important for this to work, and it depends on what platform you're on. Here above, we've shown the forward slashes like you would use for a linux system (since we're using the babun shell, our file system will look like a linux system), but on windows, you'd need to use backwards slashes.
                                    <br>
                                    all together, your first paramater should form an absolute file path
                                    If your target_folder is <code>/home/user/me</code> and your file_name is <code>test.png</code> your full paramater will be the absolute path to the file, which should be: <br>
                                    <code>/home/user/me/test.png</code> (this is the linux format)
                                    <br>
                                </p>

                                <br>
                                <p>
                                    Now, at this point, we just need to call the <code>run_actions</code> function we've written on all of the files in the directory by using <code>os.listdir()</code> Everything we have so far should look something like this:
                                </p>
                                <br>
                                <img src="img/cleanup_11.png">
                                <br>
                                <p>
                                    At this point, you should  be able to run the code, so long as you update the .json file to point to an actual directory on your computer!
                                </p>
                                <br>
                                <div class = "alert alert-danger">
                                    You might have some errors if you don't have permissions for the files or folders you're trying to move from or into, make sure of that before you start
                                </div>
                                <br>
                                <p>
                                    It might be helpful to add a <code>print</code> statement in the <code>move_file</code> function to let you see that your program is actually doing something.
                                </p>
                                <br>
                                <img src="img/cleanup_12.png">
                                <br>
                                <p>
                                    (you can use a comma to print the contents of multiple variables on the same line)
                                </p>
                                <br>
                                <p>
                                    And now, you can finally see some proof that you are doing something!
                                </p>
                                <img src="img/cleanup_13.png">
                                <p>
                                    From here, all that remains is enhancing the program to add other tasks, and other conditions. The next task you can easily add, is one that allows you to delete a file based on a condition.
                                </p>
                                <br>
                                <p>
                                    Thankfully, there's also a simple built in standard library function you can use to delete files. <code>os.remove()</code> can be used by passing a path to the file as the only paramater to this function.
                                    You can write a second function <code>delete_file</code> that looks something like this:
                                </p>
                                <pre><code class="python">
def delete_file(path, target):
    print "Deleting File: ", path
    os.remove(path)

tasks = {
    'move': move_file,
    'delete': delete_file
}
                                    </code></pre>
                                    <br>
                                    <p> We're going to keep the same signature (they'll all take the same paramaters), to allow us to keep things simple when we're running the tasks. We don't have to write any more code now for this task to work, we can just write a new action for it in our configuration file.</p>
                                    <br>
                                    <img src="img/cleanup_14.png">
                                    <p> We can add a new rule, like this that deletes all files with .txt or .exe extensions, and it should automatically work </p>
                                    <br>
                                    <img src="img/cleanup_15.png">
                                    <br>
                                    <p>
                                        From here, we can add additional conditions to check on the file, to see if we should execute a particular action. The next easy one that you can implement, is to check a file's name.
                                    </p>
<pre><code class="python">
elif action['type'] == "file_name" and action['name'] in file_name:
    tasks[action['task']](target_folder+"/"+file_name, action['target']) 
</code></pre>
<br>
<p> this condition that we can add to our <code>run_actions</code> function, will check if whatever we put in the "name" key of an action, is in the file's name.
</p>
<br>
<p> So you can use it in your configuration file like this: </p>
<br>
<img src="img/cleanup_16.png">
<br>
<p>
    And then once the rule exists and you've added the <code>if</code> condition to check for file name as an action type, you should be able to run the program again, and get it to delete or move files by name,
    </p>
    <br>

<img src="img/cleanup_17.png">
<br>
<p> Finally, the last condition that you can include, is to perform some action files based on how old they are. This can be pretty useful if you want to delete or move files that are older than a certain date.
    To do that, we'll need to figure out the file's modified date, and figure out how many days that is from today. 
</p>
<br>
<p>
    Fortunately, again there's functionality already in the standard library to help us do this. We've already imported the <code>os</code> module, and now we will use a function called <code>os.path.getmtime()</code>
    as well as python's <code>datetime</code> module in order to deal with the dates. We can use <code>getmtime</code> to get the modified date from a file by passing a path to that file, and then use the function <code>datetime.fromtimestamp</code> to convert the timestamp that you get back from the previous function call, and get an object that you can easily work with in python  like this:
</p>
<br>
<pre><code class="python">
from datetime import datetime

# this gets us a timestamp
file_timestamp = os.path.getmtime(file_name)

# this returns an object that represents the exact modified date of the file
file_date = datetime.fromtimestamp(file_timestamp)

</code></pre>
<br>
<p>
    The condition we're going to make, will let us specify an action to take based on how many days old a file is, to figure that out, we'll can subtract the file's modified date from today's date and get how many days are in that date difference. 
    Python's <code>datetime</code> allows us to just subtract the date objects using the regular arithmetic operator. To get today's date, we can use <code>datetime.now()</code>. After subtracting the date, we can get the <code>.days</code> attribute from the result of our subtraction, to figure out how many days old our file is. 
</p>
<br>
<pre><code class="python">days_from_today = (datetime.now() - file_date).days</pre></code>
<br>
<p>
    Finally, with the code we have above, we can write the condition for the <code>days_old</code> case in our program:
</p>
<br>
<img src="img/cleanup_18.png">
<br>
<p> So that's about it for the functionality we're going to cover adding to this program. Here's the full program source code:
</p>
<br>
<br>
<h3> Full Program Source Code </h3>
<hr>
<pre><code class="python">
import json
import os
import shutil
from datetime import datetime


cleanup_configuration = json.loads(open("cleanup_config.json", "r").read())
target_folder = cleanup_configuration["target_folder"]
actions = cleanup_configuration["actions"]

def move_file(path, target):
    print "Moving: ", path, "to ", "Target: ", target
    shutil.move(path, target)

def delete_file(path, target):
    print "Deleting File: ", path
    os.remove(path)

tasks = {
    'move': move_file,
    'delete': delete_file
}



def run_actions(file_name, actions):
    for action in actions:

        if action['type'] == "extension" and file_name.split(".")[-1].lower() in action['name']:
            tasks[action['task']](target_folder+"/"+file_name, action['target']) 

        elif action['type'] == "file_name" and action['name'] in file_name:
            tasks[action['task']](target_folder+"/"+file_name, action['target']) 

        elif action['type'] == 'days_old':
            # this gets us a timestamp
            file_timestamp = os.path.getmtime(target_folder+"/"+file_name)

            # this returns an object that represents the exact modified date of the file
            file_date = datetime.fromtimestamp(file_timestamp)

            days_from_today = (datetime.now() - file_date).days
            
            if days_from_today >= action['name']:
                tasks[action['task']](target_folder+"/"+file_name, action['target']) 




for file_name in os.listdir(target_folder):
    run_actions(file_name, actions)
</code>
</pre>
<br>
<br>
<p>
Stay tuned for next week's python project
</p>
</div>
                </div>
            </div>
        </div>
        <!-- /#page-content-wrapper -->

    </div>

    <!-- Menu Toggle Script -->
    <script>
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
    function scrollto(el){
        $('html, body').animate({
            scrollTop: $(el).offset().top
            }, 1000);
    }
    
    </script>

</body>
</html>